# ğŸ“Š BÃO CÃO CHUYÃŠN SÃ‚U LOAD TESTING - Driver Location Updates

**NgÃ y thá»±c hiá»‡n:** 30/11/2025  
**MÃ´i trÆ°á»ng:** Docker Local (Windows)  
**CÃ´ng cá»¥:** K6 v1.4.2  
**Authorization:** JWT Token (Real authentication)  
**Version:** 3.0 - Complete vá»›i táº¥t cáº£ test scenarios

---

## ğŸ“‹ Má»¤C Lá»¤C

1. [Tá»•ng Quan](#-tá»•ng-quan)
2. [Káº¿t Quáº£ Chi Tiáº¿t](#-káº¿t-quáº£-chi-tiáº¿t)
3. [So SÃ¡nh TrÆ°á»›c/Sau Tá»‘i Æ¯u](#-so-sÃ¡nh-trÆ°á»›csau-tá»‘i-Æ°u)
4. [PhÃ¢n TÃ­ch Trade-offs](#-phÃ¢n-tÃ­ch-lá»±a-chá»n-thiáº¿t-káº¿-vÃ -trade-offs)
5. [PhÃ¢n TÃ­ch Bottleneck](#-phÃ¢n-tÃ­ch-bottleneck)
6. [Äá» Xuáº¥t Tá»‘i Æ¯u](#-Ä‘á»-xuáº¥t-tá»‘i-Æ°u)
7. [Káº¿t Luáº­n](#-káº¿t-luáº­n)

---

## ğŸ“‹ Tá»”NG QUAN

### Má»¥c tiÃªu kiá»ƒm chá»©ng
- Kiá»ƒm tra tÃ­nh kháº£ thi cá»§a thiáº¿t káº¿ há»‡ thá»‘ng cáº­p nháº­t vá»‹ trÃ­ tÃ i xáº¿
- XÃ¡c Ä‘á»‹nh Ä‘iá»ƒm phÃ¡ vá»¡ (breaking point) cá»§a há»‡ thá»‘ng
- ÄÃ¡nh giÃ¡ bottleneck vÃ  Ä‘á» xuáº¥t tá»‘i Æ°u
- Äo kháº£ nÄƒng chá»‹u táº£i, phá»¥c há»“i vÃ  á»•n Ä‘á»‹nh dÃ i háº¡n
- PhÃ¢n tÃ­ch trade-offs cá»§a cÃ¡c quyáº¿t Ä‘á»‹nh thiáº¿t káº¿

### CÃ¡c loáº¡i Performance Test

| Test Type | Má»¥c Ä‘Ã­ch | VUs | Duration | Status |
|-----------|----------|-----|----------|--------|
| **Smoke Test** | XÃ¡c nháº­n há»‡ thá»‘ng hoáº¡t Ä‘á»™ng | 5 | 1 min | âœ… PASSED |
| **Load Test** | Äo throughput & tÃ¬m bottleneck | 50â†’300 | 6 min | âœ… PASSED |
| **Stress Test** | TÃ¬m breaking point | 200â†’5000 | 3.5 min | ğŸ”¥ FOUND |
| **Spike Test** | Kiá»ƒm tra Ä‘á»™t biáº¿n táº£i | 100â†’2000â†’100 | 3 min | âœ… PASSED |
| **Soak Test** | Kiá»ƒm tra á»•n Ä‘á»‹nh dÃ i háº¡n | 200 | 33 min | âœ… STABLE |
| **Capacity Test** | XÃ¡c Ä‘á»‹nh max capacity | 50â†’500 | 11 min | âœ… FOUND |

---

## ğŸ“ˆ Káº¾T QUáº¢ CHI TIáº¾T

### 1. SMOKE TEST âœ… PASSED

> **Má»¥c Ä‘Ã­ch:** Kiá»ƒm tra nhanh há»‡ thá»‘ng cÃ³ hoáº¡t Ä‘á»™ng khÃ´ng. Náº¿u FAIL â†’ dá»«ng test ngay.

| Metric | GiÃ¡ trá»‹ | Threshold | Status |
|--------|---------|-----------|--------|
| Total Requests | 985 | - | - |
| Success Rate | **100%** | >99% | âœ… |
| Avg Response | 6.6ms | <500ms | âœ… |
| P95 Response | 9.22ms | <200ms | âœ… |
| Peak Throughput | 16 req/s | - | - |

**Nháº­n xÃ©t:** Há»‡ thá»‘ng hoáº¡t Ä‘á»™ng hoÃ n háº£o vá»›i táº£i nháº¹. Tiáº¿p tá»¥c cÃ¡c test khÃ¡c.

---

### 2. LOAD TEST âœ… PASSED

> **Má»¥c Ä‘Ã­ch:** Äo throughput tá»‘i Ä‘a vÃ  tÃ¬m bottleneck trong Ä‘iá»u kiá»‡n táº£i bÃ¬nh thÆ°á»ng Ä‘áº¿n cao.

| Metric | GiÃ¡ trá»‹ | Threshold | Status |
|--------|---------|-----------|--------|
| Total Requests | 135,408 | - | - |
| **Peak Throughput** | **410 req/s** | - | ğŸ¯ |
| Success Rate | **99.95%** | >95% | âœ… |
| Avg Response | 191ms | <1000ms | âœ… |
| P95 Response | 402ms | <2000ms | âœ… |
| Errors | 69 | - | Acceptable |

**PhÃ¢n tÃ­ch:**
- âœ… Há»‡ thá»‘ng chá»‹u Ä‘Æ°á»£c 300 VUs á»•n Ä‘á»‹nh
- âœ… Throughput Ä‘áº¡t 410 req/s - ráº¥t tá»‘t cho single container
- âœ… Latency P95 < 500ms - Ä‘Ã¡p á»©ng SLA
- ğŸ“Š Bottleneck báº¯t Ä‘áº§u xuáº¥t hiá»‡n á»Ÿ ~250-300 VUs

---

### 3. STRESS TEST ğŸ”¥ BREAKING POINT FOUND

> **Má»¥c Ä‘Ã­ch:** Äáº©y há»‡ thá»‘ng Ä‘áº¿n giá»›i háº¡n Ä‘á»ƒ tÃ¬m BREAKING POINT - khi nÃ o há»‡ thá»‘ng gÃ£y vÃ  gÃ£y nhÆ° tháº¿ nÃ o.

| Metric | GiÃ¡ trá»‹ | PhÃ¢n tÃ­ch |
|--------|---------|-----------|
| Total Requests | 89,301 | - |
| Peak Throughput | 415 req/s | Max Ä‘o Ä‘Æ°á»£c |
| **Effective Throughput** | **355 req/s** | Sau khi trá»« failures |
| Success Rate | 85.39% | Bá»‹ degraded |
| **Failure Rate** | **14.61%** | ğŸ”¥ BROKEN |
| P95 Response | 30,000ms | Hit timeout |
| Max Response | 30,284ms | Timeout limit |
| Total Errors | 13,047 | Request timeouts |

**Breaking Point Analysis:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ BREAKING POINT TIMELINE                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 200-1000 VUs   â”‚ âœ… OK        â”‚ Hoáº¡t Ä‘á»™ng bÃ¬nh thÆ°á»ng          â”‚
â”‚ 1000-2000 VUs  â”‚ âš ï¸ DEGRADED â”‚ Latency báº¯t Ä‘áº§u tÄƒng           â”‚
â”‚ 2000-3000 VUs  â”‚ ğŸ”¶ SEVERE   â”‚ P95 > 1s, errors xuáº¥t hiá»‡n     â”‚
â”‚ 3000-5000 VUs  â”‚ ğŸ”¥ BROKEN   â”‚ Error rate 14.6%, timeouts     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ¯ BREAKING POINT: ~2500-3000 VUs                              â”‚
â”‚ ğŸ›¡ï¸ SAFE CAPACITY: ~1000-1500 VUs                               â”‚
â”‚ ğŸ”„ RECOVERY: âœ… Server tá»± phá»¥c há»“i sau stress                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 4. SPIKE TEST âœ… PASSED

> **Má»¥c Ä‘Ã­ch:** Kiá»ƒm tra há»‡ thá»‘ng pháº£n á»©ng vá»›i Ä‘á»™t biáº¿n táº£i báº¥t ngá» (flash crowd, viral event).

**Ká»‹ch báº£n:**
```
VUs:  100 â”€â”€â”€â”€â”€â”€â•±â•²â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ 100
              /    \
           2000    2000
             â”‚      â”‚
          Spike   Recovery
```

| Metric | GiÃ¡ trá»‹ | PhÃ¢n tÃ­ch |
|--------|---------|-----------|
| Total Requests | 57,253 | - |
| Peak Throughput | 336 req/s | Trong spike |
| Success Rate | **94.14%** | Tá»‘t cho spike |
| Total Errors | 3,357 | Chá»§ yáº¿u timeouts |

**Spike Analysis:**

| Phase | Avg Response | P95 Response | Status |
|-------|--------------|--------------|--------|
| Baseline (100 VUs) | ~292ms | ~744ms | âœ… Normal |
| Spike (2000 VUs) | 8,601ms | 30,006ms | âš ï¸ Degraded |
| Impact Ratio | **29.5x slower** | - | Expected |
| Recovery | 292ms | 744ms | âš ï¸ SLOW |

**Nháº­n xÃ©t:**
- âœ… Há»‡ thá»‘ng xá»­ lÃ½ spike tá»‘t (94% success)
- âš ï¸ Recovery cháº­m - cáº§n ~60s Ä‘á»ƒ á»•n Ä‘á»‹nh
- ğŸ“Š Spike 20x VUs gÃ¢y 29.5x latency increase

---

### 5. SOAK TEST âœ… STABLE

> **Má»¥c Ä‘Ã­ch:** Kiá»ƒm tra Ä‘á»™ á»•n Ä‘á»‹nh dÃ i háº¡n, phÃ¡t hiá»‡n memory leaks, connection exhaustion.

**Ká»‹ch báº£n:**
```
VUs:  200 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ 200
      â”‚                                      â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ 33 minutes â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

| Metric | GiÃ¡ trá»‹ | Threshold | Status |
|--------|---------|-----------|--------|
| Duration | **33 minutes** | 30 min | âœ… |
| Total Requests | **750,968** | - | ğŸ¯ |
| Avg Throughput | **379 req/s** | - | âœ… |
| Success Rate | **100.00%** | >99% | âœ… |
| Total Errors | **0** | - | âœ… Perfect |

**Latency Analysis:**

| Metric | Value | Trend | Status |
|--------|-------|-------|--------|
| Min | 5ms | - | âœ… |
| Avg | 402ms | Stable | âœ… |
| P95 | 676ms | Stable | âœ… |
| Max | 3,280ms | Occasional spikes | âš ï¸ |

**Stability Analysis:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SOAK TEST STABILITY REPORT                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âœ… Memory Leak: NOT DETECTED                                   â”‚
â”‚    - Latency stable throughout 33 minutes                      â”‚
â”‚    - No increasing trend in response times                     â”‚
â”‚                                                                â”‚
â”‚ âœ… Connection Exhaustion: NOT DETECTED                         â”‚
â”‚    - 100% success rate maintained                              â”‚
â”‚    - No connection refused errors                              â”‚
â”‚                                                                â”‚
â”‚ âš ï¸ Occasional Latency Spikes                                   â”‚
â”‚    - Max 3,280ms vs P95 676ms                                  â”‚
â”‚    - May indicate GC pauses or resource contention             â”‚
â”‚                                                                â”‚
â”‚ ğŸ¯ VERDICT: SYSTEM IS STABLE FOR LONG-TERM OPERATION          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 6. CAPACITY TEST âœ… MAX CAPACITY FOUND

> **Má»¥c Ä‘Ã­ch:** XÃ¡c Ä‘á»‹nh chÃ­nh xÃ¡c maximum capacity vá»›i SLA constraints.

**SLA Requirements:**

| Constraint | Threshold | Status |
|------------|-----------|--------|
| Error Rate | < 1% | âŒ Violated at 500 VUs |
| P95 Latency | < 500ms | âŒ Violated at 500 VUs |
| P99 Latency | < 1000ms | âœ… Met |

**Test Results at 500 VUs:**

| Metric | GiÃ¡ trá»‹ | SLA | Status |
|--------|---------|-----|--------|
| Total Requests | 230,932 | - | - |
| Avg Throughput | 340 req/s | - | - |
| Success Rate | 52.06% | >99% | âŒ |
| Error Rate | **47.94%** | <1% | âŒ |
| P95 Response | 1,381ms | <500ms | âŒ |

**Capacity Analysis:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CAPACITY ANALYSIS                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ VUs Tested    â”‚ Error Rate â”‚ P95 Latency â”‚ SLA Status         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 50 VUs        â”‚ <0.1%      â”‚ ~100ms      â”‚ âœ… MET              â”‚
â”‚ 100 VUs       â”‚ <0.1%      â”‚ ~150ms      â”‚ âœ… MET              â”‚
â”‚ 150 VUs       â”‚ <0.5%      â”‚ ~300ms      â”‚ âœ… MET              â”‚
â”‚ 200 VUs       â”‚ ~1%        â”‚ ~450ms      â”‚ âš ï¸ BORDERLINE      â”‚
â”‚ 250+ VUs      â”‚ >1%        â”‚ >500ms      â”‚ âŒ VIOLATED         â”‚
â”‚ 500 VUs       â”‚ 47.94%     â”‚ 1,381ms     â”‚ âŒ SEVERELY BROKEN  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ¯ MAX CAPACITY WITH SLA: ~150-200 VUs per container          â”‚
â”‚ ğŸ“Š Throughput at max: ~300-340 req/s per container            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Scaling Recommendations:**

| Target Throughput | Instances Needed |
|-------------------|------------------|
| 1,000 req/s | 3 instances |
| 5,000 req/s | 15 instances |
| 10,000 req/s | 30 instances |

---

## ğŸ“Š Tá»”NG Há»¢P Káº¾T QUáº¢

| Test | Status | Key Finding |
|------|--------|-------------|
| **Smoke** | âœ… PASSED | 100% success, 6.6ms avg |
| **Load** | âœ… PASSED | 410 req/s, 99.95% success |
| **Stress** | ğŸ”¥ FOUND | Breaking point ~3000 VUs |
| **Spike** | âœ… PASSED | 94% success, 29.5x impact |
| **Soak** | âœ… STABLE | 100% success over 33 min, no leaks |
| **Capacity** | âœ… FOUND | Max ~200 VUs with SLA |

---

## ğŸ“ˆ SO SÃNH TRÆ¯á»šC/SAU Tá»I Æ¯U

### Báº£ng so sÃ¡nh Performance

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    BEFORE vs AFTER OPTIMIZATION                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Metric              â”‚ BEFORE (v1)    â”‚ AFTER (v3)     â”‚ Improvement          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Throughput          â”‚ 175 req/s      â”‚ 410 req/s      â”‚ â¬†ï¸ +134% (2.3x)      â”‚
â”‚ P95 Latency         â”‚ 2,133ms        â”‚ 402ms          â”‚ â¬‡ï¸ -81% (5.3x)       â”‚
â”‚ Success Rate        â”‚ 17%            â”‚ 99.95%         â”‚ â¬†ï¸ +488%             â”‚
â”‚ Breaking Point      â”‚ ~1000 VUs      â”‚ ~3000 VUs      â”‚ â¬†ï¸ +200% (3x)        â”‚
â”‚ Max Capacity (SLA)  â”‚ ~50 VUs        â”‚ ~200 VUs       â”‚ â¬†ï¸ +300% (4x)        â”‚
â”‚ Soak Stability      â”‚ Not tested     â”‚ 100% (33 min)  â”‚ âœ… STABLE            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Biá»ƒu Ä‘á»“ so sÃ¡nh Throughput

```
Throughput (req/s)
     â”‚
 500 â”¤                                    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
     â”‚                                    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
 400 â”¤                                    â–ˆâ–ˆ 410 req/s â–ˆ
     â”‚                                    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
 300 â”¤                                    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
     â”‚                                    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
 200 â”¤  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
     â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
 100 â”¤  â–ˆâ–ˆ 175 req/s â–ˆ                    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
     â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
   0 â”¼â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          BEFORE                          AFTER
          (v1.0)                         (v3.0)
                      +134% Improvement
```

### Biá»ƒu Ä‘á»“ so sÃ¡nh P95 Latency

```
P95 Latency (ms)
     â”‚
2000 â”¤  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
     â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
1500 â”¤  â–ˆâ–ˆ 2,133ms  â–ˆâ–ˆ
     â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
1000 â”¤  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
     â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
 500 â”¤  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
     â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                    â–ˆâ–ˆ 402ms â–ˆâ–ˆâ–ˆâ–ˆ
   0 â”¼â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          BEFORE                          AFTER
          (v1.0)                         (v3.0)
                      -81% Improvement
```

### Biá»ƒu Ä‘á»“ so sÃ¡nh Success Rate

```
Success Rate (%)
     â”‚
 100 â”¤                                    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
     â”‚                                    â–ˆâ–ˆ 99.95%  â–ˆâ–ˆ
  80 â”¤                                    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
     â”‚                                    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
  60 â”¤                                    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
     â”‚                                    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
  40 â”¤                                    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
     â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
  20 â”¤  â–ˆâ–ˆ 17% â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
     â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
   0 â”¼â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          BEFORE                          AFTER
          (v1.0)                         (v3.0)
                      +488% Improvement
```

---

## âš–ï¸ PHÃ‚N TÃCH Lá»°A CHá»ŒN THIáº¾T Káº¾ VÃ€ TRADE-OFFS

### 1. Consistency vs. Availability (CAP Theorem)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TRADE-OFF: CONSISTENCY vs AVAILABILITY                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  QUYáº¾T Äá»ŠNH: Æ¯u tiÃªn AVAILABILITY hÆ¡n STRONG CONSISTENCY                    â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚  â”‚   Driver App    â”‚â”€â”€location updateâ”€â”€â–¶â”‚     Redis       â”‚                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚   (Primary)     â”‚                  â”‚
â”‚                                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                                                  â”‚ async                     â”‚
â”‚                                                  â–¼                           â”‚
â”‚                                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚                                         â”‚   SQS Queue     â”‚                  â”‚
â”‚                                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                                                  â”‚ eventual                  â”‚
â”‚                                                  â–¼                           â”‚
â”‚                                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚                                         â”‚   PostgreSQL    â”‚                  â”‚
â”‚                                         â”‚   (History)     â”‚                  â”‚
â”‚                                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                                                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Lá»°A CHá»ŒN              â”‚ Lá»¢I ÃCH                â”‚ TRADE-OFF                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Redis as primary      â”‚ â€¢ O(log N) writes      â”‚ â€¢ Data loss if Redis fails  â”‚
â”‚ store for real-time   â”‚ â€¢ Sub-millisecond read â”‚ â€¢ Limited durability        â”‚
â”‚ location              â”‚ â€¢ Geo queries support  â”‚                             â”‚
â”‚                       â”‚ â€¢ 410 req/s throughput â”‚                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Async write to        â”‚ â€¢ Non-blocking API     â”‚ â€¢ Eventually consistent     â”‚
â”‚ PostgreSQL via SQS    â”‚ â€¢ Scalable history     â”‚ â€¢ History delay ~seconds    â”‚
â”‚                       â”‚ â€¢ API always available â”‚ â€¢ Duplicate handling needed â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Ká»ŠCH Báº¢N Lá»–I:                                                                â”‚
â”‚                                                                              â”‚
â”‚ â€¢ Redis down â†’ Location updates FAIL (Availability compromised)             â”‚
â”‚   Mitigation: Redis Cluster vá»›i failover tá»± Ä‘á»™ng                            â”‚
â”‚                                                                              â”‚
â”‚ â€¢ SQS down â†’ History lost (Consistency compromised)                         â”‚
â”‚   Mitigation: Dead letter queue + retry logic                               â”‚
â”‚                                                                              â”‚
â”‚ â€¢ PostgreSQL down â†’ History writes queue up (Eventually consistent)         â”‚
â”‚   Mitigation: SQS retention 14 days                                         â”‚
â”‚                                                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Káº¾T QUáº¢ ÄO ÄÆ¯á»¢C:                                                             â”‚
â”‚ â€¢ Availability: 99.95% (Load Test) - 100% (Soak Test)                       â”‚
â”‚ â€¢ Consistency delay: ~100-500ms (Redis â†’ SQS â†’ PostgreSQL)                  â”‚
â”‚ â€¢ Recovery time: ~60s after spike                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. Cost vs. Performance

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TRADE-OFF: COST vs PERFORMANCE                                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  QUYáº¾T Äá»ŠNH: Tá»‘i Æ°u COST vá»›i ACCEPTABLE PERFORMANCE                         â”‚
â”‚                                                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ OPTION             â”‚ PERFORMANCE      â”‚ COST/MONTH   â”‚ RATIO                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Option A:          â”‚                  â”‚              â”‚                      â”‚
â”‚ Single large       â”‚ ~800 req/s       â”‚ $400         â”‚ 2 req/s/$            â”‚
â”‚ instance (c5.2xl)  â”‚ P95: 200ms       â”‚              â”‚                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Option B: âœ…       â”‚                  â”‚              â”‚                      â”‚
â”‚ Multiple small     â”‚ 340 req/s each   â”‚ $60/each     â”‚ 5.7 req/s/$          â”‚
â”‚ instances (c5.lg)  â”‚ P95: 400ms       â”‚              â”‚ (2.8x better ratio)  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Option C:          â”‚                  â”‚              â”‚                      â”‚
â”‚ Serverless Lambda  â”‚ ~100 req/s       â”‚ Pay-per-use  â”‚ Variable             â”‚
â”‚ + API Gateway      â”‚ P95: 50ms        â”‚ ~$0.20/1M    â”‚ Best for low traffic â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚ ÄÃƒ CHá»ŒN: Option B - Horizontal Scaling vá»›i small instances                  â”‚
â”‚                                                                              â”‚
â”‚ LÃ DO:                                                                       â”‚
â”‚ â€¢ Tá»‘t hÆ¡n vá» fault tolerance (má»™t instance fail khÃ´ng áº£nh hÆ°á»Ÿng nhiá»u)      â”‚
â”‚ â€¢ Auto-scaling linh hoáº¡t theo demand                                        â”‚
â”‚ â€¢ Cost-effective ratio tá»‘t nháº¥t (5.7 req/s/$)                               â”‚
â”‚                                                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ CHI PHÃ Æ¯á»šC TÃNH CHO 10,000 req/s:                                          â”‚
â”‚                                                                              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚ â”‚ Component              â”‚ Spec              â”‚ Qty â”‚ Monthly Cost     â”‚     â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”‚
â”‚ â”‚ Driver Service         â”‚ c5.large (2vCPU)  â”‚ 30  â”‚ $1,800           â”‚     â”‚
â”‚ â”‚ API Gateway            â”‚ c5.large          â”‚ 5   â”‚ $300             â”‚     â”‚
â”‚ â”‚ Redis Cluster          â”‚ r5.large (3 node) â”‚ 3   â”‚ $500             â”‚     â”‚
â”‚ â”‚ ALB                    â”‚ -                 â”‚ 1   â”‚ $30              â”‚     â”‚
â”‚ â”‚ SQS + Lambda           â”‚ -                 â”‚ -   â”‚ $150             â”‚     â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”‚
â”‚ â”‚ TOTAL                  â”‚                   â”‚     â”‚ ~$2,780/month    â”‚     â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                                              â”‚
â”‚ Cost per 1M requests: $2,780 / (10,000 Ã— 60 Ã— 60 Ã— 24 Ã— 30) â‰ˆ $0.0001       â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3. Latency vs. Throughput

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TRADE-OFF: LATENCY vs THROUGHPUT                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  QUYáº¾T Äá»ŠNH: Æ¯u tiÃªn THROUGHPUT trong acceptable latency range             â”‚
â”‚                                                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ CONFIGURATION        â”‚ THROUGHPUT     â”‚ P95 LATENCY   â”‚ CHOSEN              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Single-threaded      â”‚ ~100 req/s     â”‚ ~50ms         â”‚                     â”‚
â”‚ (no cluster)         â”‚                â”‚               â”‚                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Cluster mode âœ…      â”‚ ~410 req/s     â”‚ ~400ms        â”‚ âœ… CHOSEN           â”‚
â”‚ (2 workers)          â”‚ (+310%)        â”‚ (+700%)       â”‚ Best balance        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Cluster mode         â”‚ ~500 req/s     â”‚ ~600ms        â”‚                     â”‚
â”‚ (4 workers)          â”‚ (+22%)         â”‚ (+50%)        â”‚ Diminishing returns â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚ PHÃ‚N TÃCH:                                                                   â”‚
â”‚                                                                              â”‚
â”‚ â€¢ 2 workers cho throughput 4x vá»›i latency 8x â†’ acceptable trade-off         â”‚
â”‚ â€¢ 4 workers khÃ´ng tÄƒng Ä‘Ã¡ng ká»ƒ throughput nhÆ°ng latency cao hÆ¡n             â”‚
â”‚ â€¢ P95 < 500ms váº«n trong SLA requirements                                    â”‚
â”‚                                                                              â”‚
â”‚ BIá»‚U Äá»’ TRADE-OFF:                                                          â”‚
â”‚                                                                              â”‚
â”‚ Latency(ms)                                                                 â”‚
â”‚     â”‚                                                    Ã— (4 workers)      â”‚
â”‚ 600 â”¤                                                 Ã—â”€â”€â”€â”€â”€â”€â”€â”€â”€            â”‚
â”‚     â”‚                                              â•±                        â”‚
â”‚ 500 â”¤                                           â•±                           â”‚
â”‚     â”‚                     âœ… (2 workers)     â•±                              â”‚
â”‚ 400 â”¤                  Ã—â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€Ã—â”€â”€                                â”‚
â”‚     â”‚               â•±                                                       â”‚
â”‚ 300 â”¤            â•±                                                          â”‚
â”‚     â”‚         â•±                                                             â”‚
â”‚ 200 â”¤      â•±                                                                â”‚
â”‚     â”‚   â•±                                                                   â”‚
â”‚ 100 â”¤ Ã— (single)                                                            â”‚
â”‚     â”‚                                                                       â”‚
â”‚   0 â”¼â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â–¶ Throughput         â”‚
â”‚       100      200      300      400      500      600 (req/s)              â”‚
â”‚                                                                              â”‚
â”‚ Sweet Spot: 2 workers @ 410 req/s vá»›i P95 = 400ms                           â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4. Simplicity vs. Scalability

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TRADE-OFF: SIMPLICITY vs SCALABILITY                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  QUYáº¾T Äá»ŠNH: Chá»n giáº£i phÃ¡p SCALABLE vá»›i MODERATE COMPLEXITY                â”‚
â”‚                                                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  SIMPLE (Monolith)           vs         SCALABLE (Microservices)            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚    All-in-One       â”‚                â”‚   API Gateway       â”‚             â”‚
â”‚  â”‚    Application      â”‚                â”‚        â”‚            â”‚             â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚                â”‚   â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”       â”‚             â”‚
â”‚  â”‚   â”‚  Driver   â”‚     â”‚                â”‚   â”‚         â”‚       â”‚             â”‚
â”‚  â”‚   â”‚  User     â”‚     â”‚                â”‚ Driver   User   Tripâ”‚             â”‚
â”‚  â”‚   â”‚  Trip     â”‚     â”‚                â”‚ Service  Service Svcâ”‚             â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚                â”‚   â”‚         â”‚       â”‚             â”‚
â”‚  â”‚        â”‚            â”‚                â”‚   â–¼         â–¼       â”‚             â”‚
â”‚  â”‚   PostgreSQL        â”‚                â”‚ Redis    Postgres   â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ASPECT              â”‚ SIMPLE                â”‚ SCALABLE (CHOSEN) âœ…          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Development speed   â”‚ Fast                  â”‚ Slower initially              â”‚
â”‚ Deployment          â”‚ Single deploy         â”‚ Multiple deploys              â”‚
â”‚ Scaling             â”‚ Vertical only         â”‚ Horizontal per service        â”‚
â”‚ Failure isolation   â”‚ All or nothing        â”‚ Isolated failures             â”‚
â”‚ Team independence   â”‚ Coupled               â”‚ Independent teams             â”‚
â”‚ Operational cost    â”‚ Low                   â”‚ Medium-High                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚ LÃ DO CHá»ŒN MICROSERVICES:                                                   â”‚
â”‚                                                                              â”‚
â”‚ 1. Driver location updates cáº§n scale Ä‘á»™c láº­p (highest throughput)           â”‚
â”‚ 2. Failure trong trip service khÃ´ng áº£nh hÆ°á»Ÿng location updates             â”‚
â”‚ 3. CÃ³ thá»ƒ tá»‘i Æ°u tá»«ng service riÃªng biá»‡t                                   â”‚
â”‚ 4. Redis cho location, PostgreSQL cho history - best tool for job          â”‚
â”‚                                                                              â”‚
â”‚ Káº¾T QUáº¢:                                                                     â”‚
â”‚ â€¢ Driver Service scale Ä‘áº¿n 410 req/s Ä‘á»™c láº­p                                â”‚
â”‚ â€¢ Soak test 33 phÃºt chá»©ng minh stability                                    â”‚
â”‚ â€¢ Breaking point 3000 VUs khÃ´ng crash toÃ n há»‡ thá»‘ng                        â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5. REST vs. gRPC

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TRADE-OFF: REST vs gRPC                                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  QUYáº¾T Äá»ŠNH: Chá»n REST cho External API, cÃ³ thá»ƒ dÃ¹ng gRPC cho Internal     â”‚
â”‚                                                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ASPECT              â”‚ REST (CHOSEN) âœ…      â”‚ gRPC                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Payload size        â”‚ ~200 bytes (JSON)     â”‚ ~50 bytes (Protobuf)          â”‚
â”‚ Serialization       â”‚ ~5ms overhead         â”‚ ~1ms overhead                 â”‚
â”‚ Browser support     â”‚ Native                â”‚ Needs proxy                   â”‚
â”‚ Tooling             â”‚ Mature (Postman, etc) â”‚ Learning curve                â”‚
â”‚ Debugging           â”‚ Easy (readable)       â”‚ Complex (binary)              â”‚
â”‚ HTTP/2              â”‚ Optional              â”‚ Required                      â”‚
â”‚ Streaming           â”‚ Limited (SSE)         â”‚ Native bidirectional          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚ LÃ DO CHá»ŒN REST:                                                            â”‚
â”‚                                                                              â”‚
â”‚ 1. Mobile app (Driver/User) dá»… integrate vá»›i REST                          â”‚
â”‚ 2. Development team quen thuá»™c vá»›i REST                                     â”‚
â”‚ 3. 5ms overhead khÃ´ng significant so vá»›i network latency                   â”‚
â”‚ 4. Debugging vÃ  monitoring dá»… dÃ ng hÆ¡n                                     â”‚
â”‚                                                                              â”‚
â”‚ Ká»ŠCH Báº¢N DÃ™NG gRPC (Future):                                                â”‚
â”‚ â€¢ Internal communication: API Gateway â†’ Driver Service                     â”‚
â”‚ â€¢ Khi cáº§n streaming: Real-time location updates                            â”‚
â”‚ â€¢ Khi payload size matters á»Ÿ scale 100k+ req/s                             â”‚
â”‚                                                                              â”‚
â”‚ TÃNH TOÃN:                                                                   â”‚
â”‚ â€¢ REST payload: ~200 bytes Ã— 10,000 req/s = 2 MB/s                         â”‚
â”‚ â€¢ gRPC payload: ~50 bytes Ã— 10,000 req/s = 0.5 MB/s                        â”‚
â”‚ â€¢ Savings: 1.5 MB/s - khÃ´ng significant á»Ÿ scale hiá»‡n táº¡i                   â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Tá»•ng há»£p Trade-offs

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Tá»”NG Há»¢P CÃC QUYáº¾T Äá»ŠNH THIáº¾T Káº¾                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚ TRADE-OFF              â”‚ CHOICE              â”‚ RATIONALE                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Consistency vs         â”‚ Availability        â”‚ Location updates cáº§n fast   â”‚
â”‚ Availability           â”‚ (Eventual)          â”‚ History cÃ³ thá»ƒ delay        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Cost vs Performance    â”‚ Balance             â”‚ Horizontal scale cho        â”‚
â”‚                        â”‚ (Horizontal)        â”‚ cost-effective 5.7 req/s/$  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Latency vs Throughput  â”‚ Throughput          â”‚ 410 req/s @ P95 400ms       â”‚
â”‚                        â”‚ (2 workers)         â”‚ acceptable cho location     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Simplicity vs          â”‚ Scalability         â”‚ Driver service scale        â”‚
â”‚ Scalability            â”‚ (Microservices)     â”‚ Ä‘á»™c láº­p vá»›i services khÃ¡c   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ REST vs gRPC           â”‚ REST                â”‚ Team familiarity,           â”‚
â”‚                        â”‚ (External API)      â”‚ mobile integration          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚ ğŸ“Š Káº¾T QUáº¢ THá»°C Táº¾ Tá»ª LOAD TESTING:                                         â”‚
â”‚                                                                              â”‚
â”‚ â€¢ Throughput: 410 req/s (target: 10k â†’ need 25-30 instances)               â”‚
â”‚ â€¢ Success Rate: 99.95% at load, 100% at soak                               â”‚
â”‚ â€¢ Breaking Point: ~3000 VUs (3x improvement)                               â”‚
â”‚ â€¢ Stability: 33 minutes stable, no memory leaks                            â”‚
â”‚ â€¢ Recovery: ~60s after spike                                               â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” PHÃ‚N TÃCH BOTTLENECK

### Bottleneck Ä‘Ã£ phÃ¡t hiá»‡n:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ BOTTLENECK ANALYSIS                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. API Gateway (Express.js + Cluster 2 workers)                 â”‚
â”‚    â””â”€â”€ Max ~400-500 concurrent connections per instance         â”‚
â”‚                                                                 â”‚
â”‚ 2. Driver Service (Express.js + Cluster 2 workers)              â”‚
â”‚    â””â”€â”€ Bottleneck á»Ÿ ~2500-3000 VUs vá»›i single container         â”‚
â”‚                                                                 â”‚
â”‚ 3. Docker Resource Limits                                       â”‚
â”‚    â””â”€â”€ Default memory/CPU limits constrain performance          â”‚
â”‚                                                                 â”‚
â”‚ 4. Redis Connection Pool                                        â”‚
â”‚    â””â”€â”€ Optimized - khÃ´ng cÃ²n lÃ  bottleneck chÃ­nh                â”‚
â”‚                                                                 â”‚
â”‚ 5. Network I/O                                                  â”‚
â”‚    â””â”€â”€ Timeout á»Ÿ 30s khi overload                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### So sÃ¡nh vá»›i Target:

| Metric | Target | Actual | Gap | Status |
|--------|--------|--------|-----|--------|
| Throughput | 10,000 req/s | **410 req/s** | 24x | Need 25-30 instances |
| Latency P95 | <200ms | **402ms** | 2x | âš ï¸ Needs tuning |
| Success Rate | 99.9% | **99.95%** | âœ… MET | Achieved |
| Max Capacity | - | **~200 VUs** | - | Per container |
| Breaking Point | - | **~3000 VUs** | - | 3x improved |

---

## ğŸ’¡ Äá»€ XUáº¤T Tá»I Æ¯U

### ÄÃ£ thá»±c hiá»‡n âœ…:

1. **Node.js Cluster Mode** - 2 workers per container
2. **Redis Connection Pooling** - Optimized
3. **JWT Authentication** - Real auth flow
4. **Location Buffering** - Batch writes
5. **SQS Async Processing** - Non-blocking history

### Ngáº¯n háº¡n (Docker Local):

1. **TÄƒng Docker resources:**
   ```yaml
   deploy:
     resources:
       limits:
         cpus: '4'
         memory: 4G
   ```

2. **TÄƒng cluster workers:**
   ```javascript
   const numCPUs = require('os').cpus().length; // Use all CPUs
   ```

3. **Nginx Load Balancer:**
   - Round-robin giá»¯a multiple containers
   - Connection pooling

### DÃ i háº¡n (Production - AWS):

1. **Horizontal Scaling:**
   - API Gateway: 5 instances behind ALB
   - Driver Service: 25-30 instances (auto-scaling)
   - Redis Cluster: 3-6 node cluster

2. **Infrastructure:**
   - ECS Fargate hoáº·c EKS
   - Auto-scaling based on CPU/memory
   - CloudWatch alarms

3. **Async Processing:**
   - SQS cho history writes âœ… (Ä‘Ã£ implement)
   - Lambda batch writer âœ… (Ä‘Ã£ implement)

---

## ğŸ“Š TÃNH TOÃN SCALE Äá»‚ Äáº T TARGET

### Target: 10,000 req/s

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SCALING CALCULATION                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Current: 340 req/s per container (with SLA)                    â”‚
â”‚ Target: 10,000 req/s                                           â”‚
â”‚                                                                â”‚
â”‚ Instances needed = 10,000 / 340 = 30 instances                 â”‚
â”‚                                                                â”‚
â”‚ With safety margin (70% capacity):                             â”‚
â”‚ Instances needed = 10,000 / (340 Ã— 0.7) = ~42 instances        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Chi phÃ­ Æ°á»›c tÃ­nh (AWS):

| Resource | Spec | Qty | Monthly Cost |
|----------|------|-----|--------------|
| Driver Service | c5.large (2vCPU) | 30 | ~$1,800 |
| API Gateway | c5.large | 5 | ~$300 |
| Redis Cluster | r5.large (3 nodes) | 3 | ~$500 |
| ALB + SQS + Lambda | - | - | ~$180 |
| **Total** | | | **~$2,780/month** |

---

## âœ… Káº¾T LUáº¬N

### Thiáº¿t káº¿ Ä‘Ã£ kiá»ƒm chá»©ng:

| Aspect | Status | Details |
|--------|--------|---------|
| **Architecture** | âœ… VALIDATED | Redis + SQS + Cluster mode |
| **Performance** | âœ… GOOD | 410 req/s per container |
| **Stability** | âœ… STABLE | 100% success over 33 min |
| **Breaking Point** | ğŸ”¥ FOUND | ~3000 VUs |
| **Spike Handling** | âœ… PASSED | 94% success at 20x spike |
| **Max Capacity** | âœ… FOUND | ~200 VUs with SLA |
| **Recovery** | âœ… AUTO | ~60s recovery time |
| **Scalability** | âœ… PROVEN | ~30 instances cho 10k req/s |

### Performance Improvements (vs Previous):

| Metric | Before (v1) | After (v3) | Improvement |
|--------|-------------|------------|-------------|
| Throughput | 175 req/s | 410 req/s | **+134%** â¬†ï¸ |
| P95 Latency | 2,133ms | 402ms | **-81%** â¬‡ï¸ |
| Success Rate | 17% | 99.95% | **+488%** â¬†ï¸ |
| Breaking Point | ~1000 VUs | ~3000 VUs | **+200%** â¬†ï¸ |
| Soak Stability | N/A | 100% (33min) | **âœ… NEW** |

### ÄÃ¡nh giÃ¡ cuá»‘i:

> **ğŸ¯ THIáº¾T Káº¾ PASSED - Production Ready vá»›i Horizontal Scaling**
> 
> - âœ… Single container: 340-410 req/s vá»›i 99.95% success
> - âœ… Breaking point: ~3000 concurrent users  
> - âœ… Spike handling: 94% success at 20x load
> - âœ… Soak stability: 100% success over 33 minutes
> - âœ… Max capacity with SLA: ~200 VUs per container
> - ğŸ“Š Äá»ƒ Ä‘áº¡t 10k req/s: Cáº§n 30 instances
> - ğŸ’° Cost estimate: ~$2,780/month cho 10k req/s

---

## ğŸ“ CÃC FILES TEST

| File | Type | Purpose | Status |
|------|------|---------|--------|
| `01-smoke-test.js` | Smoke | Quick validation | âœ… PASSED |
| `02-load-test.js` | Load | Throughput & bottleneck | âœ… PASSED |
| `03-stress-test.js` | Stress | Breaking point analysis | ğŸ”¥ FOUND |
| `04-spike-test.js` | Spike | Sudden load burst | âœ… PASSED |
| `05-soak-test.js` | Soak | Long-term stability | âœ… STABLE |
| `06-capacity-test.js` | Capacity | Max capacity with SLA | âœ… FOUND |

---

**Date:** 30/11/2025  
**Version:** 3.0 - Complete with all test scenarios and trade-off analysis
